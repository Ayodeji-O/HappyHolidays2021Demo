// GlobalResources.js - Contains resources that are accessible
//                      from all areas of the demo
// Author: Ayodeji Oshinnaiye
// Dependent upon:
//  -Utility.js
//  -ResourceLoader.js
//  -WebGlUtility.js

function globalResources() {


}

globalResources.keyLevel1 = "ToyAbandonmentLevel1";
globalResources.keyLevel2 = "ToyAbandonmentLevel2";
globalResources.keyLevel3 = "ToyAbandonmentLevel3";
globalResources.keyLevel4 = "ToyAbandonmentLevel4";
globalResources.keyLevel5 = "ToyAbandonmentLevel5";
globalResources.keyLevel6 = "ToyAbandonmentLevel6";
globalResources.keyLevel7 = "ToyAbandonmentLevel7";
globalResources.keyLevel8 = "ToyAbandonmentLevel8";
globalResources.keyLevel9 = "ToyAbandonmentLevel9";
globalResources.keyLevel10 = "ToyAbandonmentLevel10";
globalResources.introImageUri = "images/HappyHolidays2021Intro.jpg";

// Shader Resource Keys
globalResources.keyFragmentShaderGouraud = "fragmentShaderGouraud";
globalResources.keyFragmentShaderPointLightGouraud = "fragmentShaderPointLightGouraud";
globalResources.keyFragmentShaderGouraudTexture = "fragmentShaderGouraudTexture";
globalResources.keyFragmentShaderBackdrop = "fragmentShaderBackdrop";
globalResources.keyFragmentShaderStandardTexture = "fragmentShaderStandardTexture";
globalResources.keyFragmentShaderStandardTextureOpacity = "fragmentShaderStandardTextureOpacity"
globalResources.keyFragmentShaderBlackFader = "fragmentShaderBlackFader";
globalResources.keyFragmentShaderHorizontalBlurConverge = "fragmentShaderHorizontalBlurConverge";
globalResources.keyVertexShaderStandardPosition = "vertexShaderStandardPosition";

globalResources.keyTextureBrownCoarseStone = "textureBrownCoarseStone";
globalResources.keyTextureChiseledIceGenetica = "textureChiseledIceGenetica";
globalResources.keyTextureLava = "textureLava";
globalResources.keyTextureDarkGreyVolcanicRock = "textureDarkGreyVolcanicRock";
globalResources.keyTextureGrass = "textureGrass";
globalResources.keyTextureSparseLeaves = "textureSparseLeaves";
globalResources.keyTextureSlateMarble = "slateMarble";
globalResources.keyTextureBeigeCarvedStone = "beigeCarvedStone";
globalResources.keyTextureVariegatedSlatePaver = "variegatedSlatePaver";
globalResources.keyTextureCrackedDryDirt = "crackedDryDirtTexture";
globalResources.keyTextureGoldShinyBrushed = "goldShinyBrushedTexture";
globalResources.keyTextureIrregularConcrete = "irregularConcreteTexture";
globalResources.keyTextureMortaredBasaltCobbleStone = "mortaredBasaltCobbleStoneTexture";
globalResources.keyTextureRoughOutcropping = "roughOutcroppingTexture";
globalResources.keyTextureStackedMetalPlate = "stackedMetalPlate";
globalResources.keyTextureGreyTiledStone = "greyTiledStone";
globalResources.keyTextureDarkWoodenCrate = "darkWoodenCrate";
globalResources.keyTextureLightCardboardBox = "lightCardboardBox";
globalResources.keyTextureLightWoodenCrate = "lightWoodenCrate";
globalResources.keyTextureMetalCrate = "metalCrate";
globalResources.keyTextureRustyMetalPanel = "rustyMetalPanel";
globalResources.keyTextureSnow = "snow";
globalResources.keyTextureIgneousRock = "igneousRock";
globalResources.keyTextureDrawnPlank = "drawnPlank";
globalResources.keyTextureDrawnMudClump = "drawnMudClump";
globalResources.keyTexturePseudoGrass = "pseudoGrass";
globalResources.keyTexturePebbleBed = "pebbleBed";
globalResources.keyTexturePseudoCarbonFiber = "pseudoCarbonFiber";
globalResources.keyTextureDrawnTile = "drawnTile";
globalResources.keyTextureStonyGrass = "stonyGrass";
globalResources.keyTextureDrawnLeaves = "drawnLeaves";
globalResources.keyTextureDrawnLeavesFlowers = "drawnLeavesFlowers";
globalResources.keyTextureWoodGrain = "woodGrain";
globalResources.keyTextureIvyHedge = "ivyHedge";
globalResources.keyTextureAutumnLeaves = "autumnLeaves";
globalResources.keyTextureHotCoal = "hotCoal";
globalResources.keyHotCharcoalBriquettesTexture = "hotCharcoalBriquettes";
globalResources.keyTextureDecorativeGlass = "decorativeGlass";
globalResources.keyTextureHotCharcoalBriquettes = "hotCharcoalBriquettes";
globalResources.keyTexturePearlizedGranite = "pearlizedGranite";
globalResources.keyTextureIrregularGreyStoneBlocks = "irregularGreyStoneBlocks";
globalResources.keyGreyBeveledTiledStoneTexture = "greyBeveledTiledStone";
globalResources.keyVariegatedMarbleTexture = "variegatedMarble";
globalResources.keyTextureHourglass = "textureHourglass";
globalResources.keyTextureUpChevron = "textureUpChevron";
globalResources.keyTextureDownChevron = "textureDownChevron";
globalResources.keyTextureLeftChevron = "textureLeftChevron";
globalResources.keyTextureRightChevron = "textureRightChevron";

globalResources.audioBackgroundMusicKey = "audioBackgroundMusic";

globalResources.keyModelTeddyProtagonistHead = "modelTeddyProtagonistHead";
globalResources.keyModelTeddyProtagonistTorso = "modelTeddyProtagonistTorso";
globalResources.keyModelTeddyProtagonistLeftArm = "modelTeddyProtagonistLeftArm";
globalResources.keyModelTeddyProtagonistRightArm = "modelTeddyProtagonistRightArm";
globalResources.keyModelTeddyProtagonistLeftLeg = "modelTeddyProtagonistLeftLeg";
globalResources.keyModelTeddyProtagonistRightLeg = "modelTeddyProtagonistRightLeg";
globalResources.keyModelStar = "modelStar";
globalResources.keyModelEnemyCoronaVirusMonster = "modelCoronavirusMonster";
globalResources.keyModelEnemyGrinch = "modelGrinch";
globalResources.keyModelEnemySnowman = "modelSnowman";
globalResources.keyModelEnemyEvilChristmasTree = "modelEvilChristmasTree";


/*


globalResources.keyFragmentShaderVerticalColorMonoSplitFraction = "fragmentShaderVerticalColorMonoSplit";
globalResources.keyVertexShaderStandardPosition = "vertexShaderStandardPosition";
globalResources.keyModelLegoProtagonistHead = "modelLegoProtagonistHead";
globalResources.keyModelLegoProtagonistHips = "modelLegoProtagonistHips";
globalResources.keyModelLegoProtagonistTorso = "modelLegoProtagonistTorso";
globalResources.keyModelLegoProtagonistLeftArm = "modelLegoProtagonistLeftArm";
globalResources.keyModelLegoProtagonistRightArm = "modelLegoProtagonistRightArm";
globalResources.keyModelLegoProtagonistLeftLeg = "modelLegoProtagonistLeftLeg";
globalResources.keyModelLegoProtagonistRightLeg = "modelLegoProtagonistRightLeg";
globalResources.keyModelEnemyGrinch = "modelEnemyGrinch";
globalResources.keyModelEnemyCoronaVirusMonster = "modelEnemyCoronavirusMonster";
globalResources.keyTextureHourglass = "textureHourglass";
globalResources.keyTextureBrownCoarseStone = "textureBrownCoarseStone";
globalResources.keyTextureLava = "textureLava";
globalResources.keyTextureGreenMutedScale = "textureGreenMutedScale";
globalResources.keyTextureTreeBark = "textureTreeBark";
globalResources.keyTextureBeigeMarble = "textureBeigeMarble";
globalResources.keyTextureIceBlock = "textureIceBlock";
globalResources.keyTextureSnowCappedStone = "textureSnowCappedStone";
globalResources.keyTextureBeigeBlotchedSmoky = "textureBeigeBlotchedSmoky";
globalResources.keyTextureSnowCappedSoil = "textureSnowCappedSoil";
globalResources.keyTextureLeftEdgeSoilWall = "textureLeftEdgeSoilWall";
globalResources.keyTextureRightEdgeSoilWall = "textureRightEdgeSoilWall";
globalResources.keyTextureBrownWavySmoky = "textureBrownWavySmoky";
globalResources.keyTextureGreyCobbledStoneWall = "textureGreyCobbledStoneWall";
globalResources.keyTextureGreyCobbledRoundedStoneWall = "textureGreyCobbledRoundedStoneWall";
globalResources.keyTextureGoldShinyBrushed = "textureGoldShinyBrushed";
globalResources.keyTextureStackedMetalPlate = "textureStackedMetalPlate";
globalResources.keyTextureMetalBrushed = "textureMetalBrushed";
globalResources.keyTextureMetalDiamondPlate = "textureMetalDiamondPlate";
globalResources.keyTextureDarkGreyVolcanicRock = "textureDarkGreyVolcanicRock";
globalResources.keyTextureGroutedStoneBackdrop = "textureGroutedStoneBackdrop";
globalResources.keyTextureGreyIrregularBrickBackdrop = "textureGreyIrregularBrick";
globalResources.keyTextureTaupeRoughSlateBackdrop = "textureTaupeRoughSlate";
globalResources.keyTextureChiseledIceGeneticaBackdrop = "textureChiseledIceGenetica";
globalResources.keyTextureLavaBackdrop = "textureLavaBackdrop";
globalResources.keyTextureGreySciFiPanelBackdrop = "textureGreySciFiPanelBackdrop";
globalResources.keyTextureRustyMetalPanelBackdrop = "textureRustyMetalPanelBackdrop";
globalResources.audioBackgroundMusicKey = "audioBackgroundMusic";

globalResources.audioContext = null;*/


/**
 * Initiates the resource loading process
 *
 * @param completionFunction A function that will be invoked
 *                           after all resource load attempts have
 *                           been completed (regardless of success
 *                           or failure)
 */
globalResources.loadResources = function(completionFunction) {
	var resourceLoader = new ResourceLoader();
	
	// The progress function will be invoked after each resource has been
	// loaded (function will receive a fractional progress indicator).
	if (Utility.validateVar(globalResources.internalResourceLoadProgressFunction)) {
		resourceLoader.setProgressFunction(globalResources.internalResourceLoadProgressFunction);
	}
	
	for (var currentResourceKey in this.resourceSourceKeyValueStore) {
		// Images/textures are loaded/decoded by a separate routine.
		if (!this.textureSourceKeys.includes(currentResourceKey)) {		
			var resourceIsBinaryData = (Utility.validateVar(globalResources.resourceBinaryStateKeyValueStore[currentResourceKey]) && 
				(globalResources.resourceBinaryStateKeyValueStore[currentResourceKey] === true));
			
			resourceLoader.addResourceSourceUri(currentResourceKey, this.resourceSourceKeyValueStore[currentResourceKey],
				resourceIsBinaryData);
		}
	}	

	var resourceLoadCompletionFunction = completionFunction;
	var resourceLoadCompletionHandler = function (loadedResourceKeyValueStore) {
		globalResources.onResourceLoadCompletion(loadedResourceKeyValueStore);
		
		// !!!!Remove this function call instance when image loading is configured...
		resourceLoadCompletionFunction();
		
		
		// Load / decode image/texture files here?

		function imageCompletionFunction() {
					
			// Create textures here? (globalResources.createTextureFromImage)
			
			// Decode any audio data as required (e.g. background music).
			resourceLoadCompletionFunction();
		}
		
		// image.onload = ....
		// image.src = ...
	}
	
	resourceLoader.initiateResourceLoading(resourceLoadCompletionHandler);
}

globalResources.loadTextureResources = function(progressFunction, completionFunction, webGlCanvasContext) {
	
	var totalImageCount = this.textureSourceKeys.length;
	var loadedImageCount = 0;
	for (var currentTextureSourceKey of this.textureSourceKeys) {
		
		var currentImage = new Image();
		currentImage.src = this.resourceSourceKeyValueStore[currentTextureSourceKey];		
		
		var makeOnLoadFunction = function(textureSourceKey) {
			var onLoadFunction = function () {			
				var imageTexture = WebGlUtility.createTextureFromImage(webGlCanvasContext, this, false);
				globalResources.textureKeyValueStore[textureSourceKey] = imageTexture;
				globalResources.textureSizeKeyValueStore[textureSourceKey] = [ this.width, this.height ];
				
				loadedImageCount++;
				if (typeof progressFunction === "function") {
					progressFunction(loadedImageCount / totalImageCount);
				}
				
				if ((loadedImageCount === totalImageCount) &&
					(typeof completionFunction === "function")) {
						
					completionFunction();				
				}
			};
			
			return onLoadFunction;			
		};
		
		currentImage.onload = makeOnLoadFunction(currentTextureSourceKey);
	}
}

/**
 * Retrieves the "main" canvas context used for drawing data
 *  to the browser window
 * @return {CanvasRenderingContext2D / WebGLRenderingContext}
 *			The canvas context used for drawing data to the
 *			browser window
 */
globalResources.getMainCanvasContext = function() {
	return typeof this.mainCanvasContext !== "undefined" ?
		this.mainCanvasContext : null;
}

/**
 * Retrieves the overlay canvas context used for drawing data
 *  to the browser window (gauge)
 * @return {CanvasRenderingContext2D / WebGLRenderingContext}
 *			The canvas context used for drawing to be
 *			superimposed on the main canvas
 */
globalResources.getGaugeOverlayCanvasContext = function() {
	return typeof this.gaugeOverlayCanvasContext !== "undefined" ?
		this.gaugeOverlayCanvasContext : null;
}

/*
 * Retrieves the overlay canvas context used for drawing data
 *  to the browser window (full screen data)
 * @return {CanvasRenderingContext2D / WebGLRenderingContext}
 *			The canvas context used for drawing to be
 *			superimposed on the main canvas
 */
globalResources.getFullScreenOverlayCanvasContext = function() {
	return typeof this.fullScreenOverlayCanvasContext !== "undefined" ?
		this.fullScreenOverlayCanvasContext : null;
}

/**
 * Sets the "main" canvas context used for drawing data to the
 *  browser window
 * @param mainCanvasContext {CanvasRenderingContext2D / WebGLRenderingContext}
 *						    The canvas context the
 *                          will be retrieved for drawing data to the browser
 *                          window
 */
globalResources.setMainCanvasContext = function(mainCanvasContext) {
	this.mainCanvasContext = mainCanvasContext;
}


/**
 * Sets the overlay canvas context used for drawing data that is
 *  to be superimposed on the main canvas (gauge)
 * @param overlayCanvasContext {CanvasRenderingContext2D / WebGLRenderingContext}
 *						       The canvas context that will be retrieved for
 *                             drawing data over the main canvas
 */
globalResources.setGaugeOverlayCanvasContext = function(overlayCanvasContext) {
	this.gaugeOverlayCanvasContext = overlayCanvasContext;
}


/**
 * Sets the overlay canvas context used for drawing data that is
 *  to be superimposed on the main canvas (full screen data)
 * @param overlayCanvasContext {CanvasRenderingContext2D / WebGLRenderingContext}
 *						       The canvas context that will be retrieved for
 *                             drawing data over the main canvas
 */
globalResources.setFullScreenOverlayCanvasContext = function(overlayCanvasContext) {
	this.fullScreenOverlayCanvasContext = overlayCanvasContext;
}

/**
 *  Retrieves the overlay texture used for superimposing data
 *   that is to be drawn over the main scene (gauge)
 *  
 *  @return {WebGLTexture} The texture that is to be used
 *                         as the overlay texture
 */
globalResources.getGaugeOverlayTexture = function() {
	return this.gaugeOverlayTexture;
}

/**
 *  Retrieves the overlay texture used for superimposing data
 *   that is to be drawn over the main scene (full screen data)
 */
globalResources.getFullScreenOverlayTexture = function() {
	return this.fullScreenOverlayTexture;
}

/**
 * Sets the overlay texture used for drawing data that is
 *  to be superimposed on the main scene (gauge)
 * @param overlayTexture {WebGLTexture} The texture that is to be used
 *                                      as an overlay texture
 */
globalResources.setGaugeOverlayTexture = function(overlayTexture) {
	this.gaugeOverlayTexture = overlayTexture;
}

/**
 * Sets the overlay texture used for drawing data that is
 *  to be superimposed on the main scene (full screen data)
 * @param overlayTexture {WebGLTexture} The texture that is to be used
 *                                      as an overlay texture
 */
globalResources.setFullScreenOverlayTexture = function(overlayTexture) {
	this.fullScreenOverlayTexture = overlayTexture;
}

/**
 * Retrieves the URI of the intro image
 * @return {String} The URI of the intro image
 */
globalResources.getIntroImageUri = function () {
	return globalResources.introImageUri;
}

/**
 * Sets the function that will receive progress
 *  events
 *
 * @param {function} A function that will receive a single,
 *                   number parameter between 0.0 - 1.0, inclusive,
 *                   representing the load progress.
 *
 */
globalResources.setLoadProgressFunction = function (progressFunction) {
	if (Utility.validateVar(progressFunction)) {		
		this.progressFunction = progressFunction;
	}
}

/**
 * Retrieves loaded resource data using a key in order
 *  to reference data within the internal key/value store
 * @param loadedResourceDataKey {String} Key into the key-value
 *                                       store containing loaded
 *                                       data
 *
 * @return {LoadedResourceData} Data associated with a loaded resource
 */
globalResources.getLoadedResourceDataByKey = function(loadedResourceDataKey) {
	return this.loadedResourceKeyValueStore[loadedResourceDataKey];
}

/**
 * Handler invoked after loading has been attempted/completed for
 *  all resources
 * 
 * @param loadedResourceKeyValueStore {Object} A key/value store containing all
 *                                             loaded resources
 */
globalResources.onResourceLoadCompletion = function (loadedResourceKeyValueStore) {
	this.loadedResourceKeyValueStore = loadedResourceKeyValueStore;
}


globalResources.internalResourceLoadProgressFunction = function (progressFraction) {
	if (typeof globalResources.progressFunction === "function") {		
		var totalProgressFraction = progressFraction *
			(Object.keys(globalResources.resourceSourceKeyValueStore).length /
			(globalResources.textureSourceKeys.length + Object.keys(globalResources.resourceSourceKeyValueStore).length));
		globalResources.progressFunction(totalProgressFraction);
	}
}

globalResources.internalImageLoadProgressFunction = function (progressFraction) {
	if (typeof globalResources.progressFunction === "function") {
		
		var baseProgressFraction =
			(Object.keys(globalResources.resourceSourceKeyValueStore).length /
			(globalResources.textureSourceKeys.length + Object.keys(globalResources.resourceSourceKeyValueStore).length));
		var totalProgressFraction = (1.0 - baseProgressFraction) * progressFraction + baseProgressFraction;
		globalResources.progressFunction(totalProgressFraction);		
	}	
}

/**
 * Decodes all loaded audio data
 *
 * @param completionFunction {Function} Completion function invoked after all
 *                                      audio data has been decoded
 */
globalResources.decodeAllAudioData = function(completionFunction) {

	for (var currentAudioDataKeyIndex = 0; currentAudioDataKeyIndex < this.audioDataSourceKeys.length; currentAudioDataKeyIndex++) {
		
		var decodeTargetAudioDataKeyIndex = currentAudioDataKeyIndex;
		function decodeSuccessCallback(audioBuffer) {
			// Audio has been decoded successfully - store the buffer, and
			// invoke the provided completion function if decoding attempts
			// have been performed on all audio buffers.
			globalResources.decodedAudioDataKeyValueStore[globalResources.audioDataSourceKeys[decodeTargetAudioDataKeyIndex]] = audioBuffer;
			
			globalResources.processedAudioDataSourceCount++
			
			if ((globalResources.processedAudioDataSourceCount == globalResources.audioDataSourceKeys.length) &&
				Utility.validateVar(completionFunction)) {
					
				completionFunction();
			}
		}
		
		function decodeErrorCallBack(audioBuffer) {
			this.processedAudioDataSourceCount++			
		}
		
		// Decode the audio data...
		audioContext = globalResources.createAudioContext();
		if (Utility.validateVar(audioContext) && Utility.validateVar(this.loadedResourceKeyValueStore) &&
			Utility.validateVar(this.loadedResourceKeyValueStore[this.audioDataSourceKeys[currentAudioDataKeyIndex]])) {

			var encodedAudioData = this.loadedResourceKeyValueStore[this.audioDataSourceKeys[currentAudioDataKeyIndex]].resourceDataStore;
			audioContext.decodeAudioData(encodedAudioData, decodeSuccessCallback, decodeErrorCallBack);
		}
	}
}

/**
 *  Creates an AudioContext object that will be required
 *   to play the background audio
 *  
 *  @return {AudioContext} AudioContext object required to play
 *                         the background audio
 */
globalResources.createAudioContext = function() {
	var audioContext = null;
	if (typeof(window.AudioContext) !== "undefined") {
		audioContext = new window.AudioContext();
	}
	else {
		// Used by Safari (validated against version 12.x)
		audioContext = new window.webkitAudioContext();
	}
	
	return audioContext;
}

/**
 *  Initiates playback of the background audio - this method must
 *   be invoked from within a click event handler in order for
 *   the audio to be played on all supported browsers (it should not
 *   be invoked an any other handler, even if the request being
 *   handled was invoked from within the click handler)
 */
globalResources.playBackgroundAudio = function() {
	globalResources.audioContext = globalResources.createAudioContext();
	globalResources.audioContext.resume();
	if (globalResources.audioContext !== null) {	
		function initiateBackgroundAudioPlayback() {
			if (Utility.validateVar(globalResources.decodedAudioDataKeyValueStore[globalResources.audioBackgroundMusicKey])) {
				var audioSource = globalResources.audioContext.createBufferSource();
				audioSource.buffer = globalResources.decodedAudioDataKeyValueStore[globalResources.audioBackgroundMusicKey];
				audioSource.connect(globalResources.audioContext.destination);
				audioSource.loop = true;
				audioSource.start(0);
			}
		}
			
		globalResources.decodeAllAudioData(initiateBackgroundAudioPlayback);
	}
}

globalResources.conditionallyRequestAccelerometerPermission = function(completionFunction) {

	if ((typeof(DeviceOrientationEvent) !== "undefined") && typeof(DeviceOrientationEvent.requestPermission) === "function") {
		// Standard method for requesting accelerometer permission under
		// Safari.
		DeviceOrientationEvent.requestPermission().then(response => {
			completionFunction();
		});
	}	
	else if (Utility.validateVar(completionFunction)) {
		completionFunction()
	}
}

globalResources.conditionallyRequestGyroscopePermission = function(completionFunction) {
	if ((typeof(DeviceMotionEvent) !== "undefined") && typeof(DeviceMotionEvent.requestPermission) === "function") {
		// Standard method for requesting gyroscope permission under
		// Safari.
		DeviceMotionEvent.requestPermission().then(response => {
			completionFunction();
		});
	}
	else if (Utility.validateVar(completionFunction)) {
		completionFunction()
	}	
}

/**
 * Initializes the global resources, loading
 *  any resources that require pre-loading
 * @param completionFuction {function} Completion function executed
 *                                     upon completion of all global
 *                                     resource loading
 */
globalResources.initialize = function(completionFunction) {
	// Create a key / value store of resources that will be 
	// used by the demo - these resources will be explicitly loaded
	// and processed directly (images can be loaded / processed by
	// the framework, and therefore should not be referenced in
	// this section).
	this.resourceSourceKeyValueStore = {};
	
	this.resourceSourceKeyValueStore[globalResources.keyTextureBrownCoarseStone] = "textures/BrownCoarseStoneTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureChiseledIceGenetica] = "textures/ChiseledIceGeneticaTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureLava] = "textures/LavaTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureGrass] = "textures/GrassTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDarkGreyVolcanicRock] = "textures/DarkGreyVolcanicRockTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureSparseLeaves] = "textures/SparseLeavesTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureSlateMarble] = "textures/SlateMarbleTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureBeigeCarvedStone] = "textures/BeigeCarvedStoneTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureTanSmoothSandStone] = "textures/TanSmoothSandStoneTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureVariegatedSlatePaver] = "textures/VariegatedSlatePaverTexture.jpg"
	this.resourceSourceKeyValueStore[globalResources.keyTextureCrackedDryDirt] = "textures/CrackedDryDirtTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureGoldShinyBrushed] = "textures/GoldShinyBrushedTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureIrregularConcrete] = "textures/IrregularConcreteTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureMortaredBasaltCobbleStone] = "textures/MortaredBasaltCobbleStoneTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureRoughOutcropping] = "textures/RoughOutcroppingTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureStackedMetalPlate] = "textures/StackedMetalPlateTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureGreyTiledStone] = "textures/GreyTiledStoneTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDarkWoodenCrate] = "textures/DarkWoodenCrateTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureLightCardboardBox] = "textures/LightCardboardBoxTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureLightWoodenCrate] = "textures/LightWoodenCrateTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureMetalCrate] = "textures/MetalCrateTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureRustyMetalPanel] = "textures/RustyMetalPanelTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureSnow] = "textures/SnowTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureIgneousRock] = "textures/IgneousRockTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDrawnPlank] = "textures/DrawnPlankTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDrawnMudClump] = "textures/DrawnMudClumpTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTexturePseudoGrass] = "textures/PseudoGrassTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTexturePebbleBed] = "textures/PebbleBedTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTexturePseudoCarbonFiber] = "textures/PseudoCarbonFiberTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDrawnTile] = "textures/DrawnTileTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTextureStonyGrass] = "textures/StonyGrassTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDrawnLeaves] = "textures/DrawnLeavesTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDrawnLeavesFlowers] = "textures/DrawnLeavesFlowersTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureWoodGrain] = "textures/WoodGrainTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTextureIvyHedge] = "textures/IvyHedgeTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTextureAutumnLeaves] = "textures/AutumnLeavesTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureHotCoal] = "textures/HotCoalTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureHotCharcoalBriquettes] = "textures/HotCharcoalBriquettesTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDecorativeGlass] = "textures/DecorativeGlassTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTexturePearlizedGranite] = "textures/PearlizedGraniteTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureIrregularGreyStoneBlocks] = "textures/IrregularGreyStoneBlocksTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyGreyBeveledTiledStoneTexture] = "textures/GreyBeveledTiledStoneTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyVariegatedMarbleTexture] = "textures/VariegatedMarbleTexture.png"
	this.resourceSourceKeyValueStore[globalResources.keyTextureStarTile] = "textures/StarTileTexture.jpg";
	this.resourceSourceKeyValueStore[globalResources.keyTextureHourglass] = "textures/HourglassTexture.png";	
	this.resourceSourceKeyValueStore[globalResources.keyTextureUpChevron] = "textures/UpChevronTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTextureDownChevron] = "textures/DownChevronTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTextureLeftChevron] = "textures/LeftChevronTexture.png";
	this.resourceSourceKeyValueStore[globalResources.keyTextureRightChevron] = "textures/RightChevronTexture.png";
	
	this.resourceSourceKeyValueStore[globalResources.audioBackgroundMusicKey] = "audio/Hopeful Holiday Homecoming.mp3";
	
	
	// Shader resources
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderGouraud] = "shaders/FragmentShaderGouraud.shader";
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderPointLightGouraud] = "shaders/FragmentShaderPointLightGouraud.shader"
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderGouraudTexture] = "shaders/FragmentShaderGouraudTexture.shader"
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderBackdrop] = "shaders/FragmentShaderBackdrop.shader"
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderStandardTexture] = "shaders/FragmentShaderStandardTexture.shader";
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderStandardTextureOpacity] = "shaders/FragmentShaderStandardTextureOpacity.shader";	
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderBlackFader] = "shaders/FragmentShaderBlackFader.shader";
	this.resourceSourceKeyValueStore[globalResources.keyFragmentShaderHorizontalBlurConverge] = "shaders/FragmentShaderHorizontalBlurConverge.shader";
	this.resourceSourceKeyValueStore[globalResources.keyVertexShaderStandardPosition] = "shaders/VertexShaderStandardPosition.shader";
	

	//this.audioDataSourceKeys = {};

	this.resourceSourceKeyValueStore[globalResources.keyLevel1] = "levels/ToyAbandonmentLevel1.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel2] = "levels/ToyAbandonmentLevel2.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel3] = "levels/ToyAbandonmentLevel3.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel4] = "levels/ToyAbandonmentLevel4.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel5] = "levels/ToyAbandonmentLevel5.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel6] = "levels/ToyAbandonmentLevel6.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel7] = "levels/ToyAbandonmentLevel7.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel8] = "levels/ToyAbandonmentLevel8.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel9] = "levels/ToyAbandonmentLevel9.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyLevel10] = "levels/ToyAbandonmentLevel10.ssls";
	this.resourceSourceKeyValueStore[globalResources.keyModelTeddyProtagonistHead] = "models/Teddy_Bear_Head.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelTeddyProtagonistTorso] = "models/Teddy_Bear_Torso.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelTeddyProtagonistLeftArm] = "models/Teddy_Bear_Left_Arm.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelTeddyProtagonistRightArm] = "models/Teddy_Bear_Right_Arm.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelTeddyProtagonistLeftLeg] = "models/Teddy_Bear_Left_Leg.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelTeddyProtagonistRightLeg] = "models/Teddy_Bear_Right_Leg.obj"; 
	this.resourceSourceKeyValueStore[globalResources.keyModelStar] = "models/Star.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelEnemyCoronaVirusMonster] = "models/Coronavirus_Monster.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelEnemyGrinch] = "models/Grinch.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelEnemySnowman] = "models/Snowman.obj";
	this.resourceSourceKeyValueStore[globalResources.keyModelEnemyEvilChristmasTree] = "models/Evil_Christmas_Tree.obj";
	
	this.resourceBinaryStateKeyValueStore = {};
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel1] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel2] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel3] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel4] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel5] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel6] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel7] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel8] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel9] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.keyLevel10] = true;
	this.resourceBinaryStateKeyValueStore[globalResources.audioBackgroundMusicKey] = true;
		
	this.audioDataSourceKeys = [globalResources.audioBackgroundMusicKey];	
	
	this.textureSourceKeys = 
	[
		globalResources.keyTextureBrownCoarseStone,
		globalResources.keyTextureChiseledIceGenetica,
		globalResources.keyTextureLava,
		globalResources.keyTextureDarkGreyVolcanicRock,
		globalResources.keyTextureGrass,
		globalResources.keyTextureSparseLeaves,
		globalResources.keyTextureSlateMarble,
		globalResources.keyTextureBeigeCarvedStone,
		globalResources.keyTextureTanSmoothSandStone,
		globalResources.keyTextureVariegatedSlatePaver,		
		globalResources.keyTextureCrackedDryDirt,
		globalResources.keyTextureGoldShinyBrushed,
		globalResources.keyTextureIrregularConcrete,
		globalResources.keyTextureMortaredBasaltCobbleStone,
		globalResources.keyTextureRoughOutcropping,
		globalResources.keyTextureStackedMetalPlate,
		globalResources.keyTextureGreyTiledStone,
		globalResources.keyTextureDarkWoodenCrate,
		globalResources.keyTextureLightCardboardBox,
		globalResources.keyTextureLightWoodenCrate,
		globalResources.keyTextureMetalCrate,
		globalResources.keyTextureRustyMetalPanel,
		globalResources.keyTextureSnow,
		globalResources.keyTextureIgneousRock,
		globalResources.keyTextureDrawnPlank,
		globalResources.keyTextureDrawnMudClump,
		globalResources.keyTexturePseudoGrass,
		globalResources.keyTexturePebbleBed,
		globalResources.keyTexturePseudoCarbonFiber,
		globalResources.keyTextureDrawnTile,
		globalResources.keyTextureStonyGrass,
		globalResources.keyTextureDrawnLeaves,
		globalResources.keyTextureDrawnLeavesFlowers,
		globalResources.keyTextureWoodGrain,
		globalResources.keyTextureIvyHedge,
		globalResources.keyTextureAutumnLeaves,
		globalResources.keyTextureHotCoal,
		globalResources.keyTextureHotCharcoalBriquettes,
		globalResources.keyTextureDecorativeGlass,
		globalResources.keyTexturePearlizedGranite,
		globalResources.keyTextureIrregularGreyStoneBlocks,
		globalResources.keyGreyBeveledTiledStoneTexture,
		globalResources.keyVariegatedMarbleTexture,
		globalResources.keyTextureStarTile,
		globalResources.keyTextureHourglass,
		globalResources.keyTextureUpChevron,
		globalResources.keyTextureDownChevron,
		globalResources.keyTextureLeftChevron,
		globalResources.keyTextureRightChevron,
	];	
	
	/*
		globalResources.keyTextureGroutedStoneBackdrop,
		globalResources.keyTextureGreyIrregularBrickBackdrop,
		globalResources.keyTextureTaupeRoughSlateBackdrop,
		globalResources.keyTextureChiseledIceGeneticaBackdrop,
		globalResources.keyTextureLavaBackdrop,
		globalResources.keyTextureGreySciFiPanelBackdrop,
		globalResources.keyTextureRustyMetalPanelBackdrop
	];*/
	
	this.textureKeyValueStore = {};
	this.textureSizeKeyValueStore = {};
	
	this.decodedAudioDataKeyValueStore = {};
	this.processedAudioDataSourceCount = 0;

	function mainResourceLoadCompletionFunction () {
		globalResources.loadTextureResources(globalResources.internalImageLoadProgressFunction, completionFunction,
			globalResources.getMainCanvasContext());
	}
	
	this.loadResources(mainResourceLoadCompletionFunction);
}